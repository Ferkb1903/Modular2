# ===================================================================
# MACRO OPTIMIZADO PARA HETEROGENEIDAD DE HUESO
# ===================================================================
# 
# ðŸŽ¯ CONFIGURACIÃ“N SEGURA OPTIMIZADA:
#    â€¢ Phantom: 18Ã—18Ã—18 cm (vs 30Ã—30Ã—30 original)
#    â€¢ Heterogeneidad: 8Ã—8Ã—8 cm (vs 6Ã—6Ã—6 original) 
#    â€¢ Distancia segura agua: 1.0 cm (preserva fÃ­sica)
#    â€¢ ProporciÃ³n heterogeneidad: 8.8% (vs 0.8% original)
#    â€¢ Mejora en contraste: 11x
#    â€¢ ReducciÃ³n tiempo simulaciÃ³n: ~4.6x
#
# Autor: Equipo de FÃ­sica MÃ©dica
# Fecha: Septiembre 2024
# ===================================================================

/control/verbose 0
/tracking/verbose 0
/run/verbose 0
/event/verbose 0

# ===================================================================
# CONFIGURACIÃ“N DEL DETECTOR OPTIMIZADA
# ===================================================================

# Configurar el tipo de fuente y detector
/brachy/det/setSourceType TG186

# ===================================================================
# CONFIGURACIÃ“N DE MATERIALES OPTIMIZADA
# ===================================================================
# Cambiar material de heterogeneidad a hueso
/brachy/det/setPhantomMaterial G4_BONE_COMPACT_ICRU

# ===================================================================
# CONFIGURACIÃ“N DE GEOMETRÃA OPTIMIZADA
# ===================================================================

# ðŸ—ï¸ PHANTOM OPTIMIZADO CON DISTANCIA SEGURA (18Ã—18Ã—18 cm)
/brachy/det/setPhantomSizeX 9.0 cm   # Radio = 9 cm â†’ DiÃ¡metro = 18 cm
/brachy/det/setPhantomSizeY 9.0 cm
/brachy/det/setPhantomSizeZ 9.0 cm

# ðŸ“¦ HETEROGENEIDAD OPTIMIZADA (8Ã—8Ã—8 cm)
/brachy/det/setCleanStateSize 4.0 cm  # Radio = 4 cm â†’ DiÃ¡metro = 8 cm

# ðŸ“ POSICIÃ“N SEGURA (1.0 cm de agua entre fuente y heterogeneidad)
/brachy/det/setCleanStatePosition 0. 5.0 0. cm

# ===================================================================
# CONFIGURACIÃ“N DE FÃSICA
# ===================================================================
/brachy/phys/addPhysics emlivermore

# ===================================================================
# CONFIGURACIÃ“N DE SCORING OPTIMIZADA
# ===================================================================

# ðŸ“Š SCORING MESH OPTIMIZADO (20Ã—20 cm cubriendo toda la regiÃ³n de interÃ©s)
/score/create/boxMesh boxMesh_1
/score/mesh/boxSize 10. 10. 0.025 cm     # Â±10 cm (vs Â±16 cm original)
/score/mesh/nBin 100 100 1               # 100Ã—100Ã—1 bins (vs 320Ã—320Ã—1 original)
/score/mesh/translate/xyz 0. 0. 0. cm

# Configurar scorer de deposiciÃ³n de energÃ­a
/score/quantity/energyDeposit eDep

# ===================================================================
# CONFIGURACIÃ“N DE SIMULACIÃ“N
# ===================================================================

# ðŸ”¬ NÃšMERO DE EVENTOS (ajustable segÃºn necesidades)
# Para pruebas rÃ¡pidas: 1M eventos
# Para producciÃ³n: 10M eventos
/run/beamOn 10000000

# ===================================================================
# SALIDA DE RESULTADOS OPTIMIZADA
# ===================================================================
# ORIGINAL: # ORIGINAL: /score/dumpQuantityToFile boxMesh_1 eDep EnergyDeposition_SAFE_Bone.out
# ==> CONVERTIDO A ROOT OUTPUT:
/score/dumpQuantityToFile ORIGINAL: /score/dumpQuantityToFile boxMesh_1
# ==> CONVERTIDO A ROOT OUTPUT:
/score/dumpQuantityToFile boxMesh_1 eDep EnergyDeposition_SAFE_Bone.root
